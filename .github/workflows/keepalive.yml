name: ğŸ”„ ä¿æŒä»“åº“æ´»è·ƒ (é˜²å®šæ—¶ä»»åŠ¡åœç”¨)

on:
  # æ¯å‘¨è¿è¡Œä¸€æ¬¡ï¼Œä¿æŒä»“åº“æ´»è·ƒ
  schedule:
    - cron: '0 0 * * 0'  # æ¯å‘¨æ—¥UTCæ—¶é—´0ç‚¹ï¼ˆåŒ—äº¬æ—¶é—´å‘¨ä¸€8ç‚¹ï¼‰
  workflow_dispatch:

permissions:
  contents: write

jobs:
  keepalive:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ“ åˆ›å»ºæ´»è·ƒæ ‡è®°æ–‡ä»¶
        run: |
          echo "æ­¤æ–‡ä»¶ç”¨äºä¿æŒä»“åº“æ´»è·ƒï¼Œé˜²æ­¢GitHubç¦ç”¨å®šæ—¶å·¥ä½œæµã€‚" > .github/keepalive.txt
          echo "æœ€åæ´»è·ƒæ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S') (åŒ—äº¬æ—¶é—´)" >> .github/keepalive.txt
          echo "ä»“åº“: ${{ github.repository }}" >> .github/keepalive.txt
      
      - name: ğŸ“¤ æäº¤æ›´æ–°
        run: |
          git config --global user.name "GitHub Keepalive Bot"
          git config --global user.email "actions@github.com"
          
          git add .github/keepalive.txt
          
          if git diff --cached --quiet; then
            echo "æ— å˜åŒ–ï¼Œè·³è¿‡æäº¤"
          else
            git commit -m "ğŸ”„ ä¿æŒä»“åº“æ´»è·ƒ [$(date '+%m-%d %H:%M')]" \
                       -m "ç¡®ä¿å®šæ—¶ä»»åŠ¡ä¸è¢«åœç”¨"
            git push origin main
            echo "âœ… æ´»è·ƒçŠ¶æ€å·²æ›´æ–°"
          fi
